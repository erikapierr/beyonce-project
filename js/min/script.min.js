var bandsWidget={artist:"Beyonce",response:[],toTop:function(){$("html, body").animate({scrollTop:$("#response").offset().top},750)},clickOrEnter:function(){bandsWidget.toTop(),bandsWidget.location=$(".location").val(),bandsWidget.artist="Beyonce",bandsWidget.makeRequest()},init:function(){$("#submit-button").on("click",function(t){t.preventDefault(),bandsWidget.clickOrEnter()}),$("#submit-button").keypress(function(t){$("#submit-button").blur(),13==t&&(t.preventDefault(),bandsWidget.clickOrEnter())})},makeRequest:function(){$.ajax({url:"http://api.bandsintown.com/artists/"+bandsWidget.artist+"/events/search.json?callback=showArtist",type:"GET",dataType:"jsonp",data:{format:"json",app_id:"beyonceapi",api_version:"2.0",date:"upcoming",location:bandsWidget.location},success:bandsWidget.parseData})},parseData:function(t){bandsWidget.response=t,t.length>0&&"Beyonce"==bandsWidget.artist?(bandsWidget.showArtistDiv(bandsWidget.beyDiv),lastfmWidget.addDate(),lastfmWidget.activateClock):0===t.length&&"Beyonce"==bandsWidget.artist?bandsWidget.showArtistDiv(bandsWidget.noBeyonce):0===t.length&&"Beyonce"!=bandsWidget.artist?bandsWidget.showArtistDiv(bandsWidget.noOtherArtist):void 0===bandsWidget.location||(t.length>0&&"Beyonce"!=bandsWidget.artist?(bandsWidget.showArtistDiv(bandsWidget.otherArtist),lastfmWidget.addDate(),lastfmWidget.activateClock()):$("p.invalid-entry").css("display","block"))},beyDiv:$(".bey-in-town"),noBeyonce:$(".bey-not-in-town"),noOtherArtist:$(".other-not-in-town"),otherArtist:$(".other-in-town"),error:$(".error"),showArtistDiv:function(t){$(".is-bey-touring").css("display","none"),$(".option").css("display","none"),$(t).css("display","block"),$("p.invalid-entry").css("display","none")}},lastfmWidget={artistList:[],artistImg:[],artistURL:[],generatedArtists:[],artistToSearch:"beyonce",init:function(){$.ajax({url:"http://ws.audioscrobbler.com/2.0/?method=artist.getsimilar",type:"GET",dataType:"jsonp",data:{artist:lastfmWidget.artistToSearch,format:"json",autocorrect:"1",api_key:"bedc1174f8b58bdc8c711c3292f922d8"},success:lastfmWidget.parseData})},parseData:function(t){for(var e=0;99>e;e++){var a=t.similarartists.artist[e];"Whitney Houston"!=a.name&&"Destiny's Child"!=a.name&&"Spice Girls"!=a.name&&"Michael Jackson"!=a.name&&"Aaliyah"!=a.name&&"TLC"!=a.name&&(lastfmWidget.artistList.push(a.name),lastfmWidget.artistImg.push(a.image[3]["#text"]))}lastfmWidget.loadNewArtists(),lastfmWidget.tryAgain()},random:[],createRandomArray:function(){for(var t=0;94>t;t++)lastfmWidget.random.push(t)},Shuffle:function(t){for(var e,a,i=t.length;i;e=parseInt(Math.random()*i),a=t[--i],t[i]=t[e],t[e]=a);return t},newArtistGenerator:function(t){return function(){$(".new-artist:eq("+t+")").find("a").attr("href",lastfmWidget.artistURL[lastfmWidget.random[0]]),$(".new-artist:eq("+t+")").find("img").attr("src",lastfmWidget.artistImg[lastfmWidget.random[0]]),$(".new-artist:eq("+t+")").find("p").text(lastfmWidget.artistList[lastfmWidget.random[0]]),lastfmWidget.random.splice(0,1)}},loadNewArtists:function(){lastfmWidget.createRandomArray(),lastfmWidget.Shuffle(lastfmWidget.random);for(var t=0;6>t;t++)lastfmWidget.generatedArtists[t]=lastfmWidget.newArtistGenerator(t);for(var e=0;6>e;e++)lastfmWidget.generatedArtists[e]()},tryAgain:function(){var t=$(".new-artist").find("a");t.on("click",function(t){t.preventDefault(),bandsWidget.toTop(),lastfmWidget.artistToSearch=$(this).text(),bandsWidget.artist=$(this).text(),bandsWidget.makeRequest(),lastfmWidget.loadNewArtists(),$(".your-artist").text(bandsWidget.artist)})},addDate:function(){bandsWidget.response.length>0&&($(".concert-date").text(bandsWidget.response[0].formatted_datetime+" at "+bandsWidget.response[0].venue.name),$(".other-in-town").find("a").attr("href",bandsWidget.response[0].ticket_url))},activateClock:function(){if(bandsWidget.response.length>0)lastfmWidget.dateTime=bandsWidget.response[0].datetime.split("T"),lastfmWidget.date=lastfmWidget.dateTime[0].split("-"),lastfmWidget.time=lastfmWidget.dateTime[1].split(":"),$(".clock").countdown(lastfmWidget.date[0]+"/"+lastfmWidget.date[1]+"/"+lastfmWidget.date[2]+" "+lastfmWidget.time[0]+":"+lastfmWidget.time[1]+":"+lastfmWidget.time[2],function(t){$(this).text(t.strftime("%D days %H:%M:%S"))});else if(0===bandsWidget.response.length)return null}};$(document).ready(function(){bandsWidget.init(),lastfmWidget.init()});